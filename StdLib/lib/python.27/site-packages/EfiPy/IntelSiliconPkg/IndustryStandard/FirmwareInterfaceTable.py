# FirmwareInterfaceTable.py
#
# Copyright (C) 2017 efipy.core@gmail.com All rights reserved.
#
# FirmwareInterfaceTable.py is free software: you can redistribute it and/or
# modify it under the terms of the GNU General Public License as published by
# the Free Software Foundation, version 2 of the License.
#
# EfiPy is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with EfiPy.  If not, see <http://www.gnu.org/licenses/>.
#

from EfiPy  import *

FIT_TYPE_00_HEADER                  = 0x00
FIT_TYPE_01_MICROCODE               = 0x01
FIT_TYPE_02_STARTUP_ACM             = 0x02
FIT_TYPE_07_BIOS_STARTUP_MODULE     = 0x07
FIT_TYPE_08_TPM_POLICY              = 0x08
FIT_TYPE_09_BIOS_POLICY             = 0x09
FIT_TYPE_0A_TXT_POLICY              = 0x0A
FIT_TYPE_0B_KEY_MANIFEST            = 0x0B
FIT_TYPE_0C_BOOT_POLICY_MANIFEST    = 0x0C
FIT_TYPE_10_CSE_SECURE_BOOT         = 0x10
FIT_TYPE_2D_TXTSX_POLICY            = 0x2D
FIT_TYPE_2F_JMP_DEBUG_POLICY        = 0x2F
FIT_TYPE_7F_SKIP                    = 0x7F

FIT_POINTER_ADDRESS                 = 0xFFFFFFC0
FIT_TYPE_VERSION                    = 0x0100

def FIT_TYPE_00_SIGNATURE():
  return SIGNATURE_64 ('_', 'F', 'I', 'T', '_', ' ', ' ', ' ')

class FIRMWARE_INTERFACE_TABLE_ENTRY (Structure):
  _pack_   = 1
  _fields_ = [
    ("Address",   UINT64),
    ("Size",      UINT8 * 3),
    ("Reserved",  UINT8),
    ("Version",   UINT16),
    ("Type",      UINT8, 7),
    ("C_V",       UINT8, 1),
    ("Chksum",    UINT8),
  ]
