# ShellDynamicCommand.py
#
# Copyright (C) 2017 efipy.core@gmail.com All rights reserved.
#
# ShellDynamicCommand.py is free software: you can redistribute it and/or
# modify it under the terms of the GNU General Public License as published by
# the Free Software Foundation, version 2 of the License.
#
# EfiPy is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with EfiPy.  If not, see <http://www.gnu.org/licenses/>.
#

from EfiPy import *

from EfiPy.MdePkg.Protocol.Shell import SHELL_FILE_HANDLE, EFI_SHELL_PROTOCOL
from EfiPy.MdePkg.Protocol.ShellParameters import EFI_SHELL_PARAMETERS_PROTOCOL
class EFI_SHELL_DYNAMIC_COMMAND_PROTOCOL (Structure):
  pass

SHELL_COMMAND_HANDLER = CFUNCTYPE (
  EFI_STATUS,
  POINTER(EFI_SHELL_DYNAMIC_COMMAND_PROTOCOL),    #   IN *This,
  POINTER(EFI_SYSTEM_TABLE),                      #   IN *SystemTable,
  POINTER(EFI_SHELL_PARAMETERS_PROTOCOL),         #   IN *ShellParameters,
  POINTER(EFI_SHELL_PROTOCOL)                     #   IN *Shell
  )

SHELL_COMMAND_GETHELP = CFUNCTYPE (
  EFI_STATUS,
  POINTER(EFI_SHELL_DYNAMIC_COMMAND_PROTOCOL),    #   IN        *This,
  POINTER(CHAR8)                                  #   IN CONST  *Language
  )

EFI_SHELL_DYNAMIC_COMMAND_PROTOCOL._fields_ = [
  ("CommandName", POINTER(CHAR16)),
  ("Handler",     SHELL_COMMAND_HANDLER),
  ("GetHelp",     SHELL_COMMAND_GETHELP),
  ]

gEfiShellDynamicCommandProtocolGuid = EFI_GUID(0x3c7200e9, 0x005f, 0x4ea4, (0x87, 0xde, 0xa3, 0xdf, 0xac, 0x8a, 0x27, 0xc3))
